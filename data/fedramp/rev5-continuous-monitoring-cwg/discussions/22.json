{
  "id": "D_kwDOOK0ax84AfJ1S",
  "url": "https://github.com/FedRAMP/rev5-continuous-monitoring-cwg/discussions/22",
  "title": "Simplified Secure Configurations (CM-6)",
  "body": "With the new requirement for STIG / CIS L2, this one control is within the top ten for implementation time.   When you break down the requirement for secure configuration, it requires most CSP's to focus on securing configurations at multiple-levels within their infrastructure:\r\n* Cloud Service Level \r\n* OS Level\r\n* Container Level\r\n* Database Level\r\n* Kubernetes Cluster Level\r\n* Application Level\r\n  \r\nI propose that as part of this thread, we collect ideas as to how best to automate or save time on secure configuration for the most common technology stack choices, how best to programmatically verify secure configuration for monthly ConMon summarized report and identify where there are gaps that are time consuming and/or expensive for CSPs to address.   I think if we map this out, we will see a lot of very time consuming and expensive gaps for CSPs today, a lot of areas that need more clarity as to how to handle and a lot of room for us, as a community, to improve this important area.\r\n\r\n",
  "author": "cybersechawk",
  "created_at": "2025-04-04T13:36:13Z",
  "comments": [
    {
      "id": "DC_kwDOOK0ax84Awjsh",
      "url": "https://github.com/FedRAMP/rev5-continuous-monitoring-cwg/discussions/22#discussioncomment-12729121",
      "body": "I will get the ball rolling:\r\n\r\n# Simplified Secure Configurations (CM-6)\r\n\r\n## Overview\r\n\r\nThis initiative aims to address FedRAMP/StateRAMP Control CM-6: \"Configuration Settings\" by simplifying and automating secure configuration across all major layers of a CSP's technology stack. With the implementation of STIG / CIS L2 baselines now being prioritized, CM-6 ranks in the top ten for implementation effort and complexity.\r\n\r\nMost CSPs must configure and maintain secure baselines across:\r\n\r\n- Cloud Service Level (e.g., AWS, Azure, GCP)\r\n- OS Level (e.g., Windows, Linux)\r\n- Container Level (e.g., Docker, containerd)\r\n- Database Level (e.g., PostgreSQL, MySQL, SQL Server)\r\n- Kubernetes Cluster Level (e.g., kube-apiserver, kubelet, etcd)\r\n- Application Level (custom code and COTS configurations)\r\n\r\n## Objective\r\n\r\nThe goal of this community-driven effort is to:\r\n\r\n1. **Map out common gaps** in secure configuration across the stack that are:\r\n   - Time consuming\r\n   - Costly\r\n   - Ambiguous in guidance\r\n\r\n2. **Propose automation** for secure configuration wherever possible.\r\n\r\n3. **Develop tooling, scripts, and checklists** that help CSPs:\r\n   - Programmatically verify secure configuration\r\n   - Integrate checks into ConMon / Continuous Monitoring processes\r\n   - Summarize secure configuration status in monthly reports\r\n\r\n---\r\n\r\n## Notional Solution: \"SecureConfigStack\" Microframework\r\n\r\nTo kick off discussion, here's a proposed solution that we can evolve together:\r\n\r\n### Concept\r\nA lightweight, modular microframework called `SecureConfigStack` that integrates with CSP pipelines to continuously verify baseline configuration at each infrastructure level and outputs a monthly summary formatted for FedRAMP ConMon reports.\r\n\r\n### Core Components\r\n| Layer                  | Tooling Stack                                         | Automation Examples                                         |\r\n|------------------------|--------------------------------------------------------|-------------------------------------------------------------|\r\n| Cloud Service Level    | AWS Config / Azure Policy / GCP SCC                   | Automated rule checks via Terraform Validator, OPA Rego     |\r\n| OS Level               | OpenSCAP / Lynis / Ansible STIG Roles                 | Ansible playbooks with nightly cron runs                    |\r\n| Container Level        | Trivy / Docker Bench Security                         | GitLab CI scan job & block on high severity                 |\r\n| Database Level         | CIS DB Benchmarks via custom Bash or SQL scripts      | Nightly DB hardening verification + audit logging           |\r\n| Kubernetes Cluster     | kube-bench / kube-hunter / Polaris                    | Admission controller enforcing baseline (e.g., OPA/Gatekeeper) |\r\n| Application Level      | AppArmor / Snyk / custom config linters               | Validate logging, authentication, and port lockdown         |\r\n\r\n### Outputs\r\n- Monthly `secure-config-summary.json` (machine-readable)\r\n- FedRAMP/StateRAMP-ready PDF snapshot of configuration posture\r\n- Alerts for drift from secure baselines\r\n- Evidence package builder for ConMon\r\n\r\n### Use Case\r\nA CSP integrates `SecureConfigStack` into their CI/CD pipeline and cron jobs. The framework runs checks, reports status to a dashboard, and generates a FedRAMP/StateRAMP-compliant report bundle every 30 days\u2014making CM-6 a maintainable, automated, and reportable process.\r\n\r\n---\r\n\r\n## Deliverables\r\n\r\nWe aim to build:\r\n\r\n-  A matrix of secure configuration controls vs. implementation layers\r\n-  Sample scripts and Ansible/Helm modules for automated hardening\r\n-  Configuration check utilities (e.g., OpenSCAP, kube-bench, Trivy)\r\n-  ConMon-ready secure config summary templates\r\n-  GitHub Actions or GitLab CI/CD pipelines for automated validation\r\n-  Reference guides and lessons learned from CSPs\r\n\r\n---\r\n\r\n## How to Contribute\r\n\r\n- Suggest known pain points or gaps in secure configuration\r\n- Submit existing tooling you\u2019ve used or developed\r\n- Propose ideas for automation or reporting\r\n- Review and test automation scripts\r\n- Share feedback on how to streamline ConMon evidence collection\r\n\r\n---\r\n\r\n## Discussion Prompt\r\n\r\nTo get the ball rolling, please respond with:\r\n- Which configuration layer is most painful or redundant for you?\r\n- What secure configuration practices or tooling have saved you time?\r\n- Would you find value in a unified automation framework like `SecureConfigStack`?\r\n\r\n---\r\n\r\n## Long-Term Vision\r\n\r\nA reusable, pluggable framework that allows CSPs to:\r\n- Reduce time-to-compliance for CM-6\r\n- Automatically detect and report secure config drift\r\n- Standardize ConMon outputs for reviewer consumption\r\n\r\n\r\n\r\n",
      "author": "ryangmsi",
      "created_at": "2025-04-04T17:54:08Z",
      "replies": []
    },
    {
      "id": "DC_kwDOOK0ax84Awj1h",
      "url": "https://github.com/FedRAMP/rev5-continuous-monitoring-cwg/discussions/22#discussioncomment-12729697",
      "body": "Most painful config layer is a toss up between DB and OS.  DB because there are so many manual or \"additional configuration needed\" checks, such as ensuring only \"allowed\" users/roles/etc have certain permissions. The \"allowed\" part is what requires extra work, because how does the check ensure that a thing is allowed?   On the OS side, it's just the sheer number of false positives that come with running a SCAP.   \r\n\r\nWe have found that creating custom checks in our tooling to check for what we consider the correct configuration has been helpful, as we use that alongside our False Positives to be able to accept/ignore the FP checks within our tool and focus on a truer version of when we are actually failing a compliance item. For example, if I am using a fancy 3rd party tool for FIM, I'll fail the linux checks that are written to look for aide. I am meeting the control, but not in the way the SCAP has been written.  If I have a custom check for that 3rd party FIM, then I can mark the aide checks to ignore, and sub in my own FIM checks.  The difficulty here is when auditors, agencies, etc, expect results against a pristine SCAP. We provide that, but then also utilize our custom checks as part of our FP justification. Internally those custom checks allow us to get alerts when we are legitimately out of compliance. \r\n\r\nNot sure if we would find value in something like the proposed framework, as we currently utilize a 3rd party tool for most of our compliance scanning. I think the trickiness with the idea of your framework is having the centralized dashboard tool/system that the SecureConfigStack would report to - both in the sense that there needs to be a something that someone hosts and maintains (is this on the CSP? is this a SaaS service? If so, why not just use one of the existing SaaS providers that do compliance scans?), and also that CSPs are going to want to have that compliance data in a place that their teams can do workflow off of (scheduling remediation tasks with internal teams, etc). \r\n\r\nThat all said, compliance scanning as it relates to containerized environments seems to be a big ball of confusion from people I've spoken to. Clarifying a bit more, and in very concise language, what exactly needs to be scanned for my helloworld container instance running in AWS Fargate or GCP GKE, along with the expectations on how I handle all the things which are not within the scope of the CSP to remediate, or which do not make technical sense in a containerized OS, would do wonders for easing the process.  ",
      "author": "kamamanh",
      "created_at": "2025-04-04T19:00:31Z",
      "replies": [
        {
          "id": "DC_kwDOOK0ax84Awj6O",
          "url": "https://github.com/FedRAMP/rev5-continuous-monitoring-cwg/discussions/22#discussioncomment-12729998",
          "body": "## @kamamanh \u2013 \r\n\r\nThank you for the deep and insightful response. You surfaced several key pain points, db/OS config ambiguity, SCAP rigidity, FP management, container clarity, and dashboard ownership. Based on your feedback, here\u2019s a refined roadmap to evolve the `SecureConfigStack` idea:\r\n\r\n---\r\n\r\n### Focus Area 1: OS & DB Layers First\r\n\r\n**OS Layer**  \r\n- FP Justification Layer (`custom_rules.yml` with `justification`, `evidence_link`)  \r\n- Custom Profile Support for OpenSCAP + override validation  \r\n- FIM integration mapping (e.g., Wazuh, OSSEC)\r\n\r\n**DB Layer**  \r\n- \"Allowed Roles\" DSL (`only_roles: ['admin', 'readonly']`)  \r\n- SQL-driven checks per engine (Postgres, MySQL, SQL Server)  \r\n- Baseline packs mapped to CIS/STIG\r\n\r\n---\r\n\r\n### Plugin-Based Custom Checks\r\n\r\nSupport custom check injection:\r\n- YAML/JSON rule packs  \r\n- Bash/Python/SQL scripts  \r\n- Unified output schema (`check_id`, `status`, `notes`, etc.)\r\n\r\nUse for internal controls + justification in audits.\r\n\r\n---\r\n\r\n### Deployment Options\r\n\r\n| Mode                | Purpose                                  |\r\n|---------------------|-------------------------------------------|\r\n| CLI Agent           | Self-hosted scans (cron, manual, pipeline) |\r\n| CI/CD Modules       | GitHub/GitLab pipelines                  |\r\n| Optional Dashboard  | OSS UI + SaaS (for drift tracking, team workflows) |\r\n| eMASS Exporter      | `conmon.zip` + `poam-import.csv` generator |\r\n\r\n---\r\n\r\n### Container/K8s Scoping Clarity\r\n\r\n- Shared Responsibility Matrix for Fargate/GKE/EKS  \r\n- Clarify what *can* be controlled vs. what\u2019s CSP-owned  \r\n- Policy packs for image scanning, runtime configs, admission controllers\r\n\r\n---\r\n\r\n### Roadmap (Short Version)\r\n\r\n- **M1** \u2013 Community-sourced config drift matrix  \r\n- **M2** \u2013 OS/db check modules + custom override support  \r\n- **M3** \u2013 ConMon-ready outputs (PDF, JSON, ZIP)  \r\n- **M4** \u2013 CI/CD pipeline integrations  \r\n- **M5** \u2013 Optional dashboard UI  \r\n- **M6+** \u2013 Container/K8s & App-level configs\r\n\r\n---\r\n\r\n### Follow-Up\r\n\r\nWould love your take on:\r\n- Preferred format for FP overrides?  \r\n- Ideal output format for ConMon snapshots?\r\n\r\n",
          "author": "ryangmsi",
          "created_at": "2025-04-04T19:39:46Z"
        },
        {
          "id": "DC_kwDOOK0ax84AwwmU",
          "url": "https://github.com/FedRAMP/rev5-continuous-monitoring-cwg/discussions/22#discussioncomment-12781972",
          "body": "I think M0 needs to be getting clarity on the scoping.  \r\n\r\nAs far as ConMon snapshots, I think a basic chart/graph per type with pass/fall count per check severity (DISA severity, because some 3rd party tools come up with their own) in a PDF would be helpful.  We also have to realistically expect that many agencies are still going to want to get raw scans data if they have been doing so in the past and that they will lag behind CSPs in adoption of any programmatic approach. ",
          "author": "kamamanh",
          "created_at": "2025-04-09T18:02:03Z"
        }
      ]
    }
  ]
}